#!/usr/bin/env bash
set -eu -o pipefail
fail() { echo >&2 ${0##*/}: error: $*; exit 1; }

json=`curl -sS "https://poloniex.com/public?command=returnTicker"`
[[ $# = 0 ]] && jshon -k <<<"$json" | sort

for symbol; do
  x=`jshon -Q -e $symbol <<<"$json"` || fail "symbol not found: $symbol"
  jshon -e last -u <<<"$x" || fail "unexpected json: $x"
done
